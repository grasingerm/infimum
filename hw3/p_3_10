tab2 = [1 3 0 1 1 0 0 4;
           2 1 0 0 0 1 0 3;
           0 1 4 1 0 0 1 3;
          -2 -4 -1 -1 0 0 0 0];

% pivot on row 1, column 2. Most negative RCC and smallest positive ratio

tab2(1,:) = tab2(1,:) / 3

tab2 =

  Columns 1 through 5

    0.3333    1.0000         0    0.3333    0.3333
    2.0000    1.0000         0         0         0
         0    1.0000    4.0000    1.0000         0
   -2.0000   -4.0000   -1.0000   -1.0000         0

  Columns 6 through 8

         0         0    1.3333
    1.0000         0    3.0000
         0    1.0000    3.0000
         0         0         0

tab2(2,:) = tab2(2,:) - tab2(1,:);
tab2(3,:) = tab2(3,:) - tab2(1,:);
tab2

tab2 =

  Columns 1 through 5

    0.3333    1.0000         0    0.3333    0.3333
    1.6667         0         0   -0.3333   -0.3333
   -0.3333         0    4.0000    0.6667   -0.3333
   -2.0000   -4.0000   -1.0000   -1.0000         0

  Columns 6 through 8

         0         0    1.3333
    1.0000         0    1.6667
         0    1.0000    1.6667
         0         0         0

% eliminate bottom row

tab2(4,:) = tab2(4,:) + 4 * tab2(1,:)

tab2 =

  Columns 1 through 5

    0.3333    1.0000         0    0.3333    0.3333
    1.6667         0         0   -0.3333   -0.3333
   -0.3333         0    4.0000    0.6667   -0.3333
   -0.6667         0   -1.0000    0.3333    1.3333

  Columns 6 through 8

         0         0    1.3333
    1.0000         0    1.6667
         0    1.0000    1.6667
         0         0    5.3333

% pivot on row 3, column 3

tab2(3,:) = tab2(3,:) / 4

tab2 =

  Columns 1 through 5

    0.3333    1.0000         0    0.3333    0.3333
    1.6667         0         0   -0.3333   -0.3333
   -0.0833         0    1.0000    0.1667   -0.0833
   -0.6667         0   -1.0000    0.3333    1.3333

  Columns 6 through 8

         0         0    1.3333
    1.0000         0    1.6667
         0    0.2500    0.4167
         0         0    5.3333

% eliminate bottom row

tab2(4,:) = tab2(4,:) + tab2(3,:)

tab2 =

  Columns 1 through 5

    0.3333    1.0000         0    0.3333    0.3333
    1.6667         0         0   -0.3333   -0.3333
   -0.0833         0    1.0000    0.1667   -0.0833
   -0.7500         0         0    0.5000    1.2500

  Columns 6 through 8

         0         0    1.3333
    1.0000         0    1.6667
         0    0.2500    0.4167
         0    0.2500    5.7500

% pivot on row 2, column 1

tab2(2,:) = tab2(2,:) / 1.6667;
tab2(1,:) = tab2(1,:) - 0.33333 * tab2(2,:);
tab2(3,:) = tab2(3,:) + 0.0833 * tab2(2,:);
tab2(4,:) = tab2(4,:) + 0.75 * tab2(2,:);
tab2

tab2 =

  Columns 1 through 5

    0.0000    1.0000         0    0.4000    0.4000
    1.0000         0         0   -0.2000   -0.2000
   -0.0000         0    1.0000    0.1500   -0.1000
   -0.0000         0         0    0.3500    1.1000

  Columns 6 through 8

   -0.2000         0    1.0000
    0.6000         0    1.0000
    0.0500    0.2500    0.5000
    0.4500    0.2500    6.5000

% all RCCs are positive, optimal solution has been reached

diary off
